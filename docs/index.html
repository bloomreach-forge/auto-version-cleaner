<!DOCTYPE html>
    <!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 at 2024-08-06 
 | Rendered using Bloomreach Forge Maven Skin 3.2.1 based on Apache Maven Fluido Skin
-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                  <meta name="Date-Revision-yyyymmdd" content="20240806" />
              <meta http-equiv="Content-Language" content="en" />
      <title>BloomReach Version History Cleaner Documentation &#x2013; Introduction</title>
  <link rel="stylesheet" href="./css/forge-maven-skin-syntaxhighlighter-3.2.1.min.css"/>
  <link rel="stylesheet" href="./css/forge-maven-skin-3.2.1.min.css"/>
  <link rel="stylesheet" href="./css/site.css" />
  <link rel="stylesheet" href="./css/print.css" media="print" />
  <link rel="icon" type="image/png" href="./images/skin/logo_64.png" sizes="64x64">

  
  <script type="text/javascript" src="./js/forge-maven-skin-syntaxhighlighter-3.2.1.min.js"></script>
  <script type="text/javascript" src="./js/forge-maven-skin-3.2.1.min.js"></script>

            <style>.github-fork-ribbon:before { background-color: green; }</style>
</head>
<body class="topBarDisabled">
              <a target="_blank" class="github-fork-ribbon right" href="https://github.com/bloomreach-forge/version-history-cleaner"
     data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
          <div class="container-fluid">
  <div id="banner">
    <div id="logo">
                        <a href="https://bloomreach-forge.github.io">
        <img src="./images/skin/logo.png" alt="Bloomreach Forge Logo" />
      </a>
    </div>
    <div class="pull-left">              <div id="bannerLeft">    <h1>BloomReach Version History Cleaner</h1>
    </div>
              </div>
    <div class="pull-right"></div>
    <div class="clear"><hr/></div>
  </div>

  <div id="breadcrumbs">
                            <div class="links">
      <a href="https://xmdocumentation.bloomreach.com">xmdocumentation.bloomreach.com</a>
      <a href="https://github.com/bloomreach-forge">github.com/bloomreach-forge</a>
    </div>
    <ul class="breadcrumb">
    
  <li id="publishDate">published: 2024-08-06  
  </li>
  
        
            </ul>
    <div class="clear"><hr/></div>
  </div>
<div class="row-fluid">
  <div id="leftColumn" class="span2">
    <div class="well sidebar-nav">
    
    <ul class="nav nav-list">
            <li class="nav-header">Home</li>
              <li class="active">  <a href="#"><span class="none"></span>Introduction</a>
  </li>
        <li>  <a href="install.html" title="Installation">  <span class="none"></span>  Installation</a>  </li>
        <li>  <a href="config.html" title="Configuration">  <span class="none"></span>  Configuration</a>  </li>
        <li>  <a href="release-notes.html" title="Release Notes">  <span class="none"></span>  Release Notes</a>  </li>
                  <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                    <li>  <a href="project-info.html" title="Project Information">  <span class="icon-chevron-down"></span>  Project Information</a>  
    <ul class="nav nav-list">
                  <li>  <a href="dependencies.html" title="Dependencies">  <span class="none"></span>  Dependencies</a>  </li>
                        <li>  <a href="dependency-convergence.html" title="Dependency Convergence">  <span class="none"></span>  Dependency Convergence</a>  </li>
                        <li>  <a href="dependency-info.html" title="Maven Coordinates">  <span class="none"></span>  Maven Coordinates</a>  </li>
                        <li>  <a href="dependency-management.html" title="Dependency Management">  <span class="none"></span>  Dependency Management</a>  </li>
                        <li>  <a href="distribution-management.html" title="Distribution Management">  <span class="none"></span>  Distribution Management</a>  </li>
                                  <li>  <a href="issue-management.html" title="Issue Management">  <span class="none"></span>  Issue Management</a>  </li>
                        <li>  <a href="licenses.html" title="Licenses">  <span class="none"></span>  Licenses</a>  </li>
                        <li>  <a href="modules.html" title="Project Modules">  <span class="none"></span>  Project Modules</a>  </li>
                        <li>  <a href="plugin-management.html" title="Plugin Management">  <span class="none"></span>  Plugin Management</a>  </li>
                        <li>  <a href="plugins.html" title="Plugins">  <span class="none"></span>  Plugins</a>  </li>
                        <li>  <a href="scm.html" title="Source Code Management">  <span class="none"></span>  Source Code Management</a>  </li>
                        <li>  <a href="summary.html" title="Summary">  <span class="none"></span>  Summary</a>  </li>
                        <li>  <a href="team.html" title="Team">  <span class="none"></span>  Team</a>  </li>
              </ul>
  </li>
                                                                      <li>  <a href="project-reports.html" title="Project Reports">  <span class="icon-chevron-right"></span>  Project Reports</a>  </li>
        </ul>
    
          <hr />
      <div id="poweredBy">
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
                <div class="clear"></div>
              <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">  <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />  </a>
          </div>
    </div>
  </div>
  <div id="bodyColumn"  class="span10" >
    

  

    <section>
<h2><a name="Introduction"></a>Introduction</h2>

      <section>
<h3><a name="What_is_BloomReach_Version_History_Cleaner.3F"></a>What is BloomReach Version History Cleaner?</h3>
        
<p>
          BloomReach Version History Cleaner provides the following features:
        </p>
        
<ul>
          
<li>
            On document publication, it can remove surplus versions or older versions
            <i>automatically</i> based on configurations.
            See <a href="config.html">Configuration</a> page for details.
          </li>
        </ul>

        
<div class="alert alert-info">
          
<p>
            Some versions are used to keep internal branching metadata; technically the versions for the branching
            metadata contains multiple version labels.
            That kind of versions are excluded in the version history cleanup process.
          </p>
        </div>

      </section>

      <section>
<h3><a name="Running_Demo_Project"></a>Running Demo Project</h3>
        
<p>
          You can run the demo project like the following:
        </p>
        
<div class="brush: bash">
          
<div class="source"><pre>
$ mvn clean install
$ cd demo
$ mvn clean verify &amp;&amp; mvn -Pcargo.run
          </pre></div>
        </div>
        
<p>
          The demo project is configured like the following.
          So, if you edit and re-publish any documents more than three times, other than <b>Events</b>
          documents, then you will notice the older versions being removed automatically in order to keep only 3
          versions in the version history.
          But, it will keep only up to 2 versions for <b>Events</b> documents.
          Also, it will truncate the archived nodes and all the versions when a document is deleted
          due to the configuration: <code>default.truncate.ondelete: true</code> (<code>false</code> by default).
        </p>
        
<div class="brush: plain">
          
<div class="source"><pre>
/hippo:configuration/hippo:modules/version-history-cleaner/hippo:moduleconfig:
  default.max.revisions: 3
  default.truncate.ondelete: true
  versionhistorycleanerdemo:eventsdocument.max.revisions: 2
          </pre></div>
        </div>
      </section>

      <section>
<h3><a name="Demo_Scenario:_Managed_Document_Versions_by_Publication"></a>Demo Scenario: Managed Document Versions by Publication</h3>
        
<p>
          By default, documents in the demo project do not have any version history initially.
          When you edit an <b>Events</b> document and publish it, it will create a version in its version
          history.
        </p>
        <img src="images/demo1.png" alt="Step 1" />
        
<p>
          After publishing the document, select <b>Document / Show revision history...</b> menu to see
          its version history.
        </p>
        
<p>
          Ignore the labeled version in gray color as it is used only to keep branching metdata internally.
          You will see only one version, excluding the labeled version in gray color, as you published it just once.
        </p>
        <img src="images/demo2.png" alt="Step 2" />
        
<p>
          Edit the document and publish it again, and you will see two versions in its version history.
        </p>
        <img src="images/demo3.png" alt="Step 3" />
        
<p>
          Edit the document and publish it one more time, and you will still see two versions, with the oldest
          version being removed automatically, because the configuration in the demo project includes
          <code>versionhistorycleanerdemo:eventsdocument.max.revisions: 2</code> to force to keep only 2 versions
          at max for <b>Events</b> documents.
        </p>
        <img src="images/demo4.png" alt="Step 4" />
        
<p>
          If you test this sceanrio on other documents such as <b>News</b> documents, then it will result in
          keeping 3 versions at max due to the configuration: <code>default.max.revisions: 3</code>.
        </p>
        
<p>
          For details on configurations, see the <a href="config.html">Configuration</a> page.
        </p>
      </section>

      <section>
<h3><a name="Demo_Scenario:_Truncaction_of_Version_History_on_Document_Deletion"></a>Demo Scenario: Truncaction of Version History on Document Deletion</h3>
        
<p>
          Find the &quot;preview&quot; variant node, with a blue document icon, of the <b>Events</b> document in CMS Console,
          and you will see its link to the <i>internal</i> JCR version history of the document.
        </p>
        <img src="images/demo5.png" alt="Step 1" />
        
<p>
          Click on the link and you will see the <i>internal</i> JCR version history node.
        </p>
        <img src="images/demo6.png" alt="Step 2" />
        
<p>
          Now, open the document in CMS UI again, take the document offline and delete the document through the
          <b>Document / Delete...</b> menu.
        </p>
        <img src="images/demo7.png" alt="Step 3" />
        
<p>
          When the document is deleted, its version history is also removed because the configuration in the demo project
          enables to truncate the version history on document deletion through the configuration:
          <code>default.truncate.ondelete: true</code>.
        </p>
        <img src="images/demo8.png" alt="Step 4" />
        
<p>
          For details on configurations, see the <a href="config.html">Configuration</a> page.
        </p>
        <br />
      </section>

    </section>

    <section>
<h2><a name="Project_status"></a>Project status</h2>
      
<p>
        Please see <a href="release-notes.html">Release Notes</a>.
      </p>
    </section>

  

    </div>
    </div>
    </div>
    <hr/>
    <footer>
    <div class="container-fluid">
      <div class="row-fluid">
          <p class="copyright">Copyright &copy;      2007&#x2013;2024
              <a href="https://www.bloomreach.com">Bloomreach</a>.
          
</p>
    </div>
            </div>
  </footer>
    </body>
</html>

